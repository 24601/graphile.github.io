<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NNK4X8M');</script><script src="https://use.fontawesome.com/c72bfae6f9.js"></script><link rel="preload" href="/component---src-layouts-index-js-f7e5fddfeabb77ba9307.js" as="script"/><link rel="preload" href="/component---src-templates-page-js-ca78909bbf695d00abae.js" as="script"/><link rel="preload" href="/path---postgraphile-production-817ef8ae64447faf0fe3.js" as="script"/><link rel="preload" href="/app-a926ea83f9bebda7f69a.js" as="script"/><link rel="preload" href="/commons-7330f5fc5392b4f3643e.js" as="script"/><script id="webpack-manifest">
            //<![CDATA[
            window.webpackManifest = {"15178676390636814000":"app-a926ea83f9bebda7f69a.js","6354438848726490000":"component---src-templates-page-js-ca78909bbf695d00abae.js","3918056598153407000":"component---src-templates-marketing-js-8cbaaee25fb0394e9769.js","3954140758598355500":"path----557518bd178906f8d58a.js","3000790572835897000":"path---history-f7f7e97128984502e679.js","9347362237655822000":"path---index-ecdae46139eaa38b4395.js","12610637221850356000":"path---graphile-build-pg-security-0cf9adf57481285fc9dd.js","8772566600393005000":"path---postgraphile-settings-4b24344ac8b6ba513908.js","8428063392933112000":"path---graphile-build-all-hooks-d2df597a1d8c45d3d0ab.js","4195836923314832400":"path---graphile-build-build-object-0973ac3df4678e8af91c.js","4555055688090620000":"path---graphile-build-context-object-cb4fb661f017631e6d80.js","8250511738979511000":"path---graphile-build-default-plugins-a0e54a0d1c910b162715.js","7205504750529626000":"path---graphile-build-getting-started-48a6e9764cd860a12b57.js","1062387460204904600":"path---graphile-build-graphile-build-b88635e4b2b01a727788.js","3771791408109622300":"path---graphile-build-hooks-938a429fcbb77ef83e23.js","7184560962273474000":"path---graphile-build-2db41d1ba8e5671d3014.js","5002895319514266000":"path---graphile-build-look-ahead-11a00824549e08b4ef0c.js","2390399147881533400":"path---graphile-build-omitting-plugins-dd2fc1dc2f4e6b952572.js","18106655623105920000":"path---graphile-build-plugin-options-64bc29b8a13f438eeafb.js","8948711028338852000":"path---graphile-build-plugins-83a3ea3ac2f191ec308f.js","18184767599037770000":"path---graphile-build-schema-builder-48e90fa6627f325bc505.js","9284278481446570000":"path---support-536ff0b3e08bd80f1310.js","6515005643110327000":"path---postgraphile-computed-columns-12bf63fea93b5bd05170.js","16069087941836857000":"path---postgraphile-connections-3bb038adec1cff30aa78.js","14828157494412298000":"path---postgraphile-crud-mutations-f701474a3eca19ecd059.js","13726931753980498000":"path---postgraphile-custom-mutations-1fbc3dfaa4164bcc75a7.js","17185268450471195000":"path---postgraphile-custom-queries-576825fe94678af2d6a0.js","11994700922543962000":"path---postgraphile-default-role-8bfc633fbf62b7cb9c55.js","3021897627100894700":"path---postgraphile-evaluating-493692f023c33bb56270.js","96033804396543090":"path---postgraphile-extending-d5fd849797f6b092b9e4.js","1943873715935326000":"path---postgraphile-filtering-d795caf016ab7666e69a.js","3195847254699379700":"path---postgraphile-013e4606f37e9b5b1886.js","15157997279410745000":"path---postgraphile-introduction-7d3ec0fedae7b66ffaec.js","2227050697239772200":"path---postgraphile-introspection-713493af60414dcd7fe4.js","14254897639210230000":"path---postgraphile-jwt-guide-47aebe93e281233ba9a5.js","16111252123784985000":"path---postgraphile-performance-c87299d88aca623861ed.js","2235565302053900300":"path---postgraphile-plugins-54b9f067a1858c32a91c.js","2838144339183239000":"path---postgraphile-postgresql-indexes-01221db27d5b349724d4.js","1169112013285621200":"path---postgraphile-postgresql-schema-design-800f9f0571edbf588d4b.js","5582517143255692000":"path---postgraphile-pricing-fb5b71367e166dd79812.js","16885969067605012000":"path---postgraphile-procedures-f54d571020ef59130233.js","10720840274885886000":"path---postgraphile-production-817ef8ae64447faf0fe3.js","1345073653814109400":"path---postgraphile-quick-start-guide-a4e8f2cbdd34b8fca5a8.js","8958514494574895000":"path---postgraphile-relations-0ac5989fdbddb8bcc6fd.js","12274565075711388000":"path---postgraphile-requirements-56f052c6de778403c1dd.js","8303140257694905000":"path---postgraphile-reserved-keywords-83cbcef6bcc20bedd1f5.js","9432930456023296000":"path---postgraphile-security-57e2a755c3bdde01af60.js","1788956004713715000":"path---postgraphile-smart-comments-82c98cb06abd50e65290.js","7404609125880101000":"path---postgraphile-subscriptions-283d8e73702cd8e884bb.js","214018445676298080":"path---postgraphile-usage-cli-bfd7cb82e370f9f592bb.js","9703967671503860000":"path---postgraphile-usage-library-33759ca81f4706e8f895.js","17830146079722576000":"path---postgraphile-usage-schema-566f5f1d03ba9bea2721.js","16226825268806257000":"path---postgraphile-usage-aec91fbcd81f6c9c4d81.js","5743476270238826000":"path---postgraphile-v-3-migration-66a2c3af3ba13c81a344.js","3778604715460237300":"path---postgraphile-v-4-new-features-7d11f72cb936aa9fbc59.js","7489246917808536000":"component---src-layouts-index-js-f7e5fddfeabb77ba9307.js"}
            //]]>
            </script><title data-react-helmet="true">Graphile | Running PostGraphile in Production</title><meta data-react-helmet="true" name="description" content="Utilities to build powerful and performant GraphQL APIs"/><meta data-react-helmet="true" name="keywords" content="GraphQL, API, Graph, PostgreSQL, PostGraphile, PostGraphQL, Postgres-GraphQL, server, plugins, introspection, reflection"/><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><script>
  !function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",[
  "/commons-7330f5fc5392b4f3643e.js","/app-a926ea83f9bebda7f69a.js","/path---postgraphile-production-817ef8ae64447faf0fe3.js","/component---src-templates-page-js-ca78909bbf695d00abae.js","/component---src-layouts-index-js-f7e5fddfeabb77ba9307.js"
])
  </script><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0 maximum-scale=5.0"/><link rel="stylesheet" href="/styles.css?t=2018-05-31T17-12-12.494Z"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"/></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NNK4X8M" height="0" width="0" style="display:none;visibility:hidden;"></iframe></noscript><div id="___gatsby"><div tabindex="-1" data-reactroot="" data-reactid="1" data-react-checksum="-1271740712"><div class="template-page" data-reactid="2"><!-- react-empty: 3 --><header class="header content absolute z-999 w-100" data-reactid="4"><nav class="navbar" data-reactid="5"><div class="container" data-reactid="6"><input type="checkbox" class="navbar-toggler input-reset" id="toggle" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" data-reactid="7"/><div class="nav-controls nested-list-reset " data-reactid="8"><div class="navbar-crosses" data-reactid="9"><span class="line line-1" data-reactid="10"> </span><span class="line line-2" data-reactid="11"> </span><span class="line line-3" data-reactid="12"> </span></div><ul class="navbar-nav flex w-100" data-reactid="13"><li class="navbar-item" data-reactid="14"><a class="nav-link " href="/" data-reactid="15"><span class="home-icon fa fa-home" data-reactid="16"></span><!-- react-text: 17 --> <!-- /react-text --><span class="home" data-reactid="18">Home</span></a></li><!-- react-empty: 19 --><!-- react-empty: 20 --><!-- react-empty: 21 --><li class="navbar-item" data-reactid="22"><a class="nav-link " href="/postgraphile/" data-reactid="23">Overview</a></li><li class="navbar-item" data-reactid="24"><a class="nav-link active" href="/postgraphile/introduction/" data-reactid="25">Documentation</a></li><li class="navbar-item" data-reactid="26"><a class="nav-link " href="/postgraphile/pricing/" data-reactid="27">Go Pro!</a></li><!-- react-empty: 28 --><!-- react-empty: 29 --><!-- react-empty: 30 --><li class="navbar-item ml-auto navbar-item-right" data-reactid="31"><span class="searchbox-container" data-reactid="32"><input id="search-box" placeholder="Search" data-reactid="33"/><span class="fa fa-search searchbox-search" data-reactid="34"></span></span></li><li class="navbar-item navbar-item-right" data-reactid="35"><a class="nav-link " href="/support/" data-reactid="36">Services</a></li><li class="navbar-item navbar-item-right" data-reactid="37"><a class="nav-link" href="https://graphql-training.com" title="GraphQL Training in London, Europe and Remote" data-reactid="38"><!-- react-text: 39 -->GraphQL Training<!-- /react-text --><!-- react-text: 40 --> <!-- /react-text --><span class="fa fa-external-link-square" data-reactid="41"></span></a></li><li class="navbar-item navbar-item-right" data-reactid="42"><a class="nav-link nav-github-link flex items-center" href="https://github.com/graphile" data-reactid="43"><span class="f3 fa fa-github" data-reactid="44"></span><!-- react-text: 45 --> <!-- /react-text --><span class="github" data-reactid="46"><!-- react-text: 47 -->Github <!-- /react-text --><span class="fa fa-external-link-square" data-reactid="48"></span></span></a></li></ul></div></div></nav></header><div class="page-content" data-reactid="49"><section data-reactid="50"><div class="container" data-reactid="51"><div class="row between-xs" data-reactid="52"><aside class="sidebar col-xs-12 col-md-3 last-xs mt3" data-reactid="53"><section data-reactid="54"><h4 class="f6 ttu fw6 mt0 mb3 bb pb2" data-reactid="55"><span data-reactid="56">Overview</span></h4><div class="nested-list-reset" data-reactid="57"><ul class="page-list nav flex-column mb5" data-reactid="58"><li class="f6 lh-copy pv1" data-reactid="59"><a class="nav-link " href="/postgraphile/introduction/" data-reactid="60"><span data-reactid="61">Introduction</span></a></li><li class="f6 lh-copy pv1" data-reactid="62"><a class="nav-link " href="/postgraphile/quick-start-guide/" data-reactid="63"><span data-reactid="64">Quick Start Guide</span></a></li><li class="f6 lh-copy pv1" data-reactid="65"><a class="nav-link " href="/postgraphile/requirements/" data-reactid="66"><span data-reactid="67">Requirements</span></a></li><li class="f6 lh-copy pv1" data-reactid="68"><a class="nav-link " href="/postgraphile/performance/" data-reactid="69"><span data-reactid="70">Performance</span></a></li><li class="f6 lh-copy pv1" data-reactid="71"><a class="nav-link " href="/postgraphile/connections/" data-reactid="72"><span data-reactid="73">Connections</span></a></li><li class="f6 lh-copy pv1" data-reactid="74"><a class="nav-link " href="/postgraphile/filtering/" data-reactid="75"><span data-reactid="76">Filtering</span></a></li><li class="f6 lh-copy pv1" data-reactid="77"><a class="nav-link " href="/postgraphile/relations/" data-reactid="78"><span data-reactid="79">Relations</span></a></li><li class="f6 lh-copy pv1" data-reactid="80"><a class="nav-link " href="/postgraphile/crud-mutations/" data-reactid="81"><span data-reactid="82">CRUD Mutations</span></a></li><li class="f6 lh-copy pv1" data-reactid="83"><a class="nav-link " href="/postgraphile/computed-columns/" data-reactid="84"><span data-reactid="85">Computed Columns</span></a></li><li class="f6 lh-copy pv1" data-reactid="86"><a class="nav-link " href="/postgraphile/custom-queries/" data-reactid="87"><span data-reactid="88">Custom Queries</span></a></li><li class="f6 lh-copy pv1" data-reactid="89"><a class="nav-link " href="/postgraphile/custom-mutations/" data-reactid="90"><span data-reactid="91">Custom Mutations</span></a></li><li class="f6 lh-copy pv1" data-reactid="92"><a class="nav-link " href="/postgraphile/smart-comments/" data-reactid="93"><span data-reactid="94">Smart Comments</span></a></li><li class="f6 lh-copy pv1" data-reactid="95"><a class="nav-link " href="/postgraphile/security/" data-reactid="96"><span data-reactid="97">Security</span></a></li><li class="f6 lh-copy pv1" data-reactid="98"><a class="nav-link " href="/postgraphile/introspection/" data-reactid="99"><span data-reactid="100">Introspection</span></a></li><li class="f6 lh-copy pv1" data-reactid="101"><a class="nav-link " href="/postgraphile/extending/" data-reactid="102"><span data-reactid="103">Extending PostGraphile</span></a></li><li class="f6 lh-copy pv1" data-reactid="104"><a class="nav-link " href="/postgraphile/plugins/" data-reactid="105"><span data-reactid="106">Plugins <a href='/postgraphile/pricing/' class="plan-supporter"><span class='first-letter'>s</span><span class='rest'>upporter</span></a> <a href='/postgraphile/pricing/' class="plan-pro"><span class='first-letter'>p</span><span class='rest'>ro</span></a></span></a></li><li class="f6 lh-copy pv1" data-reactid="107"><a class="nav-link " href="/postgraphile/subscriptions/" data-reactid="108"><span data-reactid="109">Subscriptions <a href='/postgraphile/pricing/' class="plan-supporter"><span class='first-letter'>s</span><span class='rest'>upporter</span></a></span></a></li><li class="f6 lh-copy pv1" data-reactid="110"><a class="nav-link active" href="/postgraphile/production/" data-reactid="111"><span data-reactid="112">Running in Production <a href='/postgraphile/pricing/' class="plan-pro"><span class='first-letter'>p</span><span class='rest'>ro</span></a></span></a></li><li class="f6 lh-copy pv1" data-reactid="113"><a class="nav-link " href="/postgraphile/reserved-keywords/" data-reactid="114"><span data-reactid="115">Reserved Keywords</span></a></li></ul></div></section><section data-reactid="116"><h4 class="f6 ttu fw6 mt0 mb3 bb pb2" data-reactid="117"><span data-reactid="118">Guides</span></h4><div class="nested-list-reset" data-reactid="119"><ul class="page-list nav flex-column mb5" data-reactid="120"><li class="f6 lh-copy pv1" data-reactid="121"><a class="nav-link " href="/postgraphile/evaluating/" data-reactid="122"><span data-reactid="123">Evaluating for your Project</span></a></li><li class="f6 lh-copy pv1" data-reactid="124"><a class="nav-link " href="/postgraphile/jwt-guide/" data-reactid="125"><span data-reactid="126">PostGraphile JWT Guide</span></a></li><li class="f6 lh-copy pv1" data-reactid="127"><a class="nav-link " href="/postgraphile/default-role/" data-reactid="128"><span data-reactid="129">The Default Role</span></a></li><li class="f6 lh-copy pv1" data-reactid="130"><a class="nav-link " href="/postgraphile/procedures/" data-reactid="131"><span data-reactid="132">PostgreSQL Procedures</span></a></li><li class="f6 lh-copy pv1" data-reactid="133"><a class="nav-link " href="/postgraphile/postgresql-schema-design/" data-reactid="134"><span data-reactid="135">PostgreSQL Schema Design</span></a></li><li class="f6 lh-copy pv1" data-reactid="136"><a class="nav-link " href="/postgraphile/postgresql-indexes/" data-reactid="137"><span data-reactid="138">PostgreSQL Indexes</span></a></li><li class="f6 lh-copy pv1" data-reactid="139"><a class="nav-link " href="/postgraphile/v4-new-features/" data-reactid="140"><span data-reactid="141">v4 Feature Guide</span></a></li><li class="f6 lh-copy pv1" data-reactid="142"><a class="nav-link " href="/postgraphile/v3-migration/" data-reactid="143"><span data-reactid="144">v3 → v4 Migration Guide</span></a></li></ul></div></section><section data-reactid="145"><h4 class="f6 ttu fw6 mt0 mb3 bb pb2" data-reactid="146"><span data-reactid="147">Usage</span></h4><div class="nested-list-reset" data-reactid="148"><ul class="page-list nav flex-column mb5" data-reactid="149"><li class="f6 lh-copy pv1" data-reactid="150"><a class="nav-link " href="/postgraphile/usage-cli/" data-reactid="151"><span data-reactid="152">CLI Usage</span></a></li><li class="f6 lh-copy pv1" data-reactid="153"><a class="nav-link " href="/postgraphile/usage-library/" data-reactid="154"><span data-reactid="155">Library Usage</span></a></li><li class="f6 lh-copy pv1" data-reactid="156"><a class="nav-link " href="/postgraphile/usage-schema/" data-reactid="157"><span data-reactid="158">Schema-only Usage</span></a></li></ul></div></section></aside><div class="col-xs-12 col-md-7 col-md-offset-1 first-xs main-content" data-reactid="159"><div class="row" data-reactid="160"><div class="col-xs-12" style="width:100%;" data-reactid="161"><h2 id="running-postgraphile-in-production"><a href="#running-postgraphile-in-production" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Running PostGraphile in Production</h2>
<p>When you run PostGraphile in production you'll want to ensure that people
cannot easily trigger denial of service (DOS) attacks against you. Due to the
nature of GraphQL it's easy to construct a small query that could be very
expensive for the server to run, for example:</p>
<div class="gatsby-highlight">
      <pre class="language-graphql"><code class="language-graphql">allUsers <span class="token punctuation">{</span>
  nodes <span class="token punctuation">{</span>
    postsByAuthorId <span class="token punctuation">{</span>
      nodes <span class="token punctuation">{</span>
        commentsByPostId <span class="token punctuation">{</span>
          userByAuthorId <span class="token punctuation">{</span>
            postsByAuthorId <span class="token punctuation">{</span>
              nodes <span class="token punctuation">{</span>
                commentsByPostId <span class="token punctuation">{</span>
                  userByAuthorId <span class="token punctuation">{</span>
                    postsByAuthorId <span class="token punctuation">{</span>
                      nodes <span class="token punctuation">{</span>
                        commentsByPostId <span class="token punctuation">{</span>
                          userByAuthorId <span class="token punctuation">{</span>
                            id
                          <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                      <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                  <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>There's lots of techniques for protecting your server from these kinds of
queries; the <a href="/postgraphile/plugins">Pro Plugin</a> <a href='/postgraphile/pricing/' class="plan-pro"><span class='first-letter'>p</span><span class='rest'>ro</span></a> helps you implement a
few of them. One of the most effective techniques, if you can use it, is the
that of "persisted queries" as a query whitelist. This technique will only work
if you control all the GraphQL clients that you wish to talk to your GraphQL
endpoint and if they use only static queries. If you're expecting 3rd parties
to query your API then persisted queries will not help you, and this is where
the other techniques come in handy.</p>
<p>The rest of this article relates to Pro Plugin's approach to addressing these
issues.</p>
<h3 id="sending-queries-to-read-replicas"><a href="#sending-queries-to-read-replicas" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sending queries to read replicas</h3>
<p>Probably the most important thing regarding scalability is making sure that your
master database doesn't bow under the pressure of all the clients talking to it.
One way to reduce this pressure is to offload read operations to read replicas.
In GraphQL it's easy to tell if a request will perform any writes or not: if
it's a <code class="language-text">query</code> then it's read-only, if it's a <code class="language-text">mutation</code> then it may perform
writes.</p>
<p>Using <code class="language-text">--read-only-connection &lt;string&gt;</code> <a href='/postgraphile/pricing/' class="plan-pro"><span class='first-letter'>p</span><span class='rest'>ro</span></a> you may give PostGraphile a
separate connection string to use for queries, to compliment the connection
string passed via <code class="language-text">--connection</code> which will now be used only for mutations.</p>
<p>(If you're using middleware, then you'll want to pass a read-only pool to the
<code class="language-text">readReplicaPgPool</code> option instead.)</p>
<blockquote>
<p>NOTE: We don't currently support the multi-host syntax for this connection
string, but you can use a PostgreSQL proxy such a PgPool or PgBouncer between
PostGraphile and your database to enable connecting to multiple read
replicas.</p>
</blockquote>
<h3 id="pagination-caps"><a href="#pagination-caps" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Pagination caps</h3>
<p>It's unlikely that you want users to request <code class="language-text">allUsers</code> and receive back
literally all of the users in the database. More likely you want users to use
cursor-based pagination over this connection with <code class="language-text">first</code> / <code class="language-text">after</code>. The Pro
Plugin introduces the <code class="language-text">--default-pagination-cap [int]</code> <a href='/postgraphile/pricing/' class="plan-pro"><span class='first-letter'>p</span><span class='rest'>ro</span></a> option which
enables you to enforce a pagination cap on all connections. Whatever number
you pass will be used as the pagination cap, but you can override it on a
table-by-table basis using <a href="/postgraphile/smart-comments/">smart comments</a> - in this case the <code class="language-text">@paginationCap</code> smart comment.</p>
<div class="gatsby-highlight">
      <pre class="language-sql"><code class="language-sql"><span class="token keyword">comment</span> <span class="token keyword">on</span> <span class="token keyword">table</span> users <span class="token operator">is</span>
  E<span class="token string">'@paginationCap 20\nSomeone who can log in.'</span><span class="token punctuation">;</span></code></pre>
      </div>
<h3 id="limiting-graphql-query-depth"><a href="#limiting-graphql-query-depth" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Limiting GraphQL query depth</h3>
<p>Most GraphQL queries tend to be only a few levels deep, queries like the deep
one at the top of this article are generally not required. You may use
<code class="language-text">--graphql-depth-limit [int]</code> <a href='/postgraphile/pricing/' class="plan-pro"><span class='first-letter'>p</span><span class='rest'>ro</span></a> to limit the depth of any GraphQL queries
that hit PostGraphile - any deeper than this will be discarded during query
validation.</p>
<h3 id="experimental-graphql-cost-limit"><a href="#experimental-graphql-cost-limit" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[EXPERIMENTAL] GraphQL cost limit</h3>
<p>The most powerful way of preventing DOS is to limit the cost of GraphQL queries
that may be executed against your GraphQL server. The Pro Plugin contains a
very early implementation of this technique, but the costs are not very
accurate yet. You may enable a cost limit with <code class="language-text">--graphql-cost-limit [int]</code>
<a href='/postgraphile/pricing/' class="plan-pro"><span class='first-letter'>p</span><span class='rest'>ro</span></a> and the calculated cost of any GraphQL queries will be made available on
<code class="language-text">meta</code> field in the GraphQL payload.</p>
<p>If your GraphQL query is seen to be too expensive, here's some techniques to
bring the calculated cost down:</p>
<ul>
<li>If you've not specified a limit (<code class="language-text">first</code>/<code class="language-text">last</code>) on a connection, we assume
it will return 1000 results. If you're expecting fewer than this, specify the
maximum you'd ever expect to receive.</li>
<li>Cost is based on number of expected results (without looking at the
database!) so lower your limits on connections.</li>
<li>Connections multiply the cost of their children by the number of results
they're expected to return, so lower the limits on connections.</li>
<li>Nested fields multiply costs; so pulling a connection inside a connection
inside a connection is going to be expensive - to address this, try placing
lower <code class="language-text">first</code>/<code class="language-text">last</code> values on the connections or avoiding fetching nested
data until you need to display it (split into multiple requests / only
request the data you need).</li>
<li>Subscriptions are automatically seen as 10x as expensive as queries - try
and minimise the amount of data your subscription requests.</li>
<li>Procedure connections are treated as more expensive than table connections.</li>
<li><code class="language-text">totalCount</code> on a table has a fair cost</li>
<li><code class="language-text">totalCount</code> on a procedure has a higher cost</li>
<li>Using <code class="language-text">pageInfo</code> adds significant cost to connections</li>
<li>Computed columns are seen as fairly expensive - in future we may factor in
PostgreSQL's <code class="language-text">COST</code> parameter when figuring this out.</li>
</ul>
<p>Keep in mind this is a <strong>very early</strong> implementation of cost analysis, there's
much improvement to be made. Feel free to reach out with any bad costs/queries
so we can improve it.</p></div><br data-reactid="162"/><br data-reactid="163"/><div class="col-xs-12 mt3 mb5" data-reactid="164"><div class="row between-xs" data-reactid="165"><div class="col-xs-6" data-reactid="166"><a class="" href="/postgraphile/subscriptions/" data-reactid="167"><span class="fa fa-fw fa-long-arrow-left" data-reactid="168"></span><!-- react-text: 169 --> <!-- /react-text --><!-- react-text: 170 -->Subscriptions [SUPPORTER]<!-- /react-text --></a></div><div class="col-xs-6 tr" data-reactid="171"><a class="" href="/postgraphile/reserved-keywords/" data-reactid="172"><!-- react-text: 173 -->Reserved Keywords<!-- /react-text --><!-- react-text: 174 --> <!-- /react-text --><span class="fa fa-fw fa-long-arrow-right" data-reactid="175"></span></a></div></div></div></div></div></div></div></section></div><footer class="bg-white pv5 bt b--black f6 lh-copy" data-reactid="176"><div class="container" data-reactid="177"><div class="row" data-reactid="178"><div class="col-xs-12 col-md-2 nested-list-reset " data-reactid="179"><h6 data-reactid="180">PostGraphile</h6><ul data-reactid="181"><li data-reactid="182"><a href="/postgraphile/introduction/" data-reactid="183">Introduction</a></li><li data-reactid="184"><a href="/postgraphile/security/" data-reactid="185">Security</a></li><li data-reactid="186"><a href="/postgraphile/extending/" data-reactid="187">Extending</a></li></ul></div><div class="col-xs-12 col-md-2 nested-list-reset " data-reactid="188"><h6 data-reactid="189">Graphile Build</h6><ul data-reactid="190"><li data-reactid="191"><a href="/graphile-build/" data-reactid="192">About</a></li><li data-reactid="193"><a href="/graphile-build/getting-started/" data-reactid="194">Getting Started</a></li><li data-reactid="195"><a href="/graphile-build/plugins/" data-reactid="196">Plugins</a></li></ul></div><div class="col-xs-12 col-md-4 nested-list-reset" data-reactid="197"><h6 data-reactid="198">Community</h6><ul data-reactid="199"><li data-reactid="200"><a href="https://github.com/graphile" data-reactid="201">GitHub</a></li><li data-reactid="202"><a href="https://gitter.im/graphile/postgraphile" data-reactid="203">Gitter chat</a></li><li data-reactid="204"><a href="https://twitter.com/benjie" data-reactid="205">Twitter</a></li></ul></div><div class="col-xs-12 col-md-4" data-reactid="206"><h6 data-reactid="207">About</h6><!-- react-text: 208 -->PostGraphile and Graphile Build are Open Source Software, maintained by <!-- /react-text --><a href="https://twitter.com/benjie" data-reactid="209">Benjie Gillam</a><!-- react-text: 210 -->.<!-- /react-text --><br data-reactid="211"/><!-- react-text: 212 -->PostGraphile was <!-- /react-text --><a href="/history/" data-reactid="213">originally authored</a><!-- react-text: 214 --> as PostGraphQL by<!-- /react-text --><!-- react-text: 215 --> <!-- /react-text --><a href="https://twitter.com/calebmer" data-reactid="216">Caleb Meredith</a><!-- react-text: 217 -->.<!-- /react-text --><br data-reactid="218"/><br data-reactid="219"/><!-- react-text: 220 -->This site is copyright © Benjie Gillam <!-- /react-text --><!-- react-text: 221 -->2018<!-- /react-text --><!-- react-text: 222 -->. Design and logo copyright © Jof Arnold <!-- /react-text --><!-- react-text: 223 -->2018<!-- /react-text --><!-- react-text: 224 -->.<!-- /react-text --></div></div></div></footer></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script></body></html>